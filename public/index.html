<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìŠˆíŒ… ì‹œë®¬ë ˆì´í„°</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      overflow: hidden;
    }
    .screen { display: none; height: 100vh; align-items: center; justify-content: center; flex-direction: column; }
    #login, #lobby, #game { display: flex; }
    input, button {
      font-size: 18px;
      padding: 10px;
      border: none;
      border-radius: 4px;
      margin: 5px;
    }
    button { background: #333; color: white; cursor: pointer; }
    #slots { display: flex; gap: 20px; margin: 30px; }
    .slot {
      width: 150px; height: 150px; background: #222;
      display: flex; align-items: center; justify-content: center;
      border-radius: 8px;
      border: 2px solid #555;
      flex-direction: column;
    }
    .empty { color: #555; }
    .playerName { margin-top: 5px; font-size: 14px; }
    #msg { color: #f66; margin-top: 20px; }
  </style>
</head>
<body>
  <!-- ì²« í™”ë©´ -->
  <div id="login" class="screen" style="display:flex;">
    <h1>ğŸ¯ ìŠˆíŒ… ì‹œë®¬ë ˆì´í„°</h1>
    <input id="nickname" placeholder="ì•„ì´ë”” ì…ë ¥" />
    <button id="enterBtn">ëŒ€ê¸°ë°© ì…ì¥</button>
    <div id="msg"></div>
  </div>

  <!-- ëŒ€ê¸°ë°© -->
  <div id="lobby" class="screen">
    <h2>ğŸ§© ëŒ€ê¸°ë°©</h2>
    <div id="slots"></div>
    <div>
      <button id="readyBtn">ê²Œì„ ì¤€ë¹„</button>
      <button id="startBtn" style="display:none;">ê²Œì„ ì‹œì‘</button>
    </div>
  </div>

  <!-- ê²Œì„í™”ë©´ (ì¶”í›„ êµ¬í˜„) -->
  <div id="game" class="screen">
    <h1>âš”ï¸ ê²Œì„ ì‹œì‘!</h1>
  </div>

  <script>
    const socket = new WebSocket(location.origin.replace(/^http/, 'ws'));

    const login = document.getElementById("login");
    const lobby = document.getElementById("lobby");
    const game = document.getElementById("game");
    const msg = document.getElementById("msg");
    const slots = document.getElementById("slots");
    const enterBtn = document.getElementById("enterBtn");
    const readyBtn = document.getElementById("readyBtn");
    const startBtn = document.getElementById("startBtn");
    const nickname = document.getElementById("nickname");

    let playerId = Math.random().toString(36).substr(2, 9);
    let isHost = false;

    enterBtn.onclick = () => {
      if (!nickname.value.trim()) return msg.textContent = "ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”!";
      socket.send(JSON.stringify({ type: "join", id: playerId, name: nickname.value }));
    };

    readyBtn.onclick = () => socket.send(JSON.stringify({ type: "ready" }));
    startBtn.onclick = () => socket.send(JSON.stringify({ type: "start" }));

    socket.onmessage = (e) => {
      const data = JSON.parse(e.data);

      if (data.type === "lobbyUpdate") {
        showLobby(data.players, data.host);
      }

      if (data.type === "gameStart") {
        showScreen(game);
      }
    };

    function showLobby(players, hostId) {
      showScreen(lobby);
      slots.innerHTML = "";
      for (let i = 0; i < 3; i++) {
        const p = players[i];
        const div = document.createElement("div");
        div.className = "slot";
        if (p) {
          div.style.borderColor = p.color;
          div.innerHTML = `<div style="color:${p.color};">${p.name}${p.isHost ? " ğŸ‘‘" : ""}</div>`;
        } else {
          div.innerHTML = `<div class="empty">(ë¹ˆ ìë¦¬)</div>`;
        }
        slots.appendChild(div);
      }
      const me = players.find(p => p.id === playerId);
      isHost = me?.isHost;
      startBtn.style.display = isHost ? "inline-block" : "none";
    }

    function showScreen(target) {
      [login, lobby, game].forEach(s => s.style.display = "none");
      target.style.display = "flex";
    }
  </script>
</body>
</html>










